rm(list = ls())

library(expm)

p <- matrix(c(1,     0,   0,    0,    0, 
             0.5, 0.2, 0.2, 0.02, 0.08,
             0.2, 0.1, 0.6, 0.02, 0.08,
             0,     0,   0,  2/3,  1/3,
             0,     0,   0,  1/3, 2/3), 5, 5, 
           byrow = TRUE)

# a)
r1 <- matrix(c(0.2, 0.2, 0.08,
             0.1, 0.6, 0.08,
             0, 0, 2/3), 3, 3, 
           byrow = TRUE)

solve(diag(3) - r1, c(0.02, 0.02, 1/3)) 

## b)
p[3,3] ^ 3

## c)
r2 <- matrix(c(0.2, 0.2,
               0.1, 0.6), 2, 2, 
            byrow = TRUE)
solve(diag(2) - r2, rep(1, 2)) 

## d)
v <-c(0, 60, 40, 0, 0)
v %*% (p %^% 100)

